#include <stdio.h>
#include <stdlib.h>

int main(void) {
    char *ptr = malloc(1024);
    char *ptr2;

    int heap = (int)ptr & 0xfff00000; // ptr & ~(HEAP_MAX_SIZE-1) - 0x08000000
    int found=0;
    printf("ptr found @ %p\n", ptr);  // Direction of chunk

    for(int i=2; i < 1024; i++) {
        if(!found && (((int)(ptr2=malloc(1024)) & 0xfff00000) == \
                                            (heap + 0x100000))) {
            printf("good heap alignment found on malloc() %i (%p)\n", i, ptr2);
            found = 1;
            break;
        }
    }

    malloc(1024);
    fread(ptr, 1024*1024, 1, stdin);
    free(ptr);
    free(ptr2);

    return(0);
}